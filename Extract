import os
from ratings_pipeline import extract_frames_quarter_second


# def extract_frames_quarter_second(video_path, output_folder):
#     # Open the video file
#     cap = cv2.VideoCapture(video_path)

#     # Get the frame rate (FPS) of the video
#     fps = cap.get(cv2.CAP_PROP_FPS)
#     total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
#     duration = total_frames / fps  # Calculate the total duration of the video in seconds
    
#     # Make the output folder if it doesn't exist
#     if not os.path.exists(output_folder):
#         os.makedirs(output_folder)

#     frame_count = 0
#     extracted_frames = 0

#     # Iterate over every 1/4 second of the video
#     for quarter_second in range(int(duration * 4)):  # Multiply duration by 4 to get 1/4 second intervals
#         target_frame = quarter_second * (fps / 4)  # Target frame for the current 1/4 second
#         cap.set(cv2.CAP_PROP_POS_FRAMES, target_frame)  # Move to that frame

#         # Read the frame
#         ret, frame = cap.read()
#         if ret:
#             frame_filename = os.path.join(output_folder, f"{os.path.basename(video_path)}_frame_{quarter_second}.jpg")
#             cv2.imwrite(frame_filename, frame)  # Save the frame
#             extracted_frames += 1

#         frame_count += 1

#     # Release the video capture object
#     cap.release()

video_path = os.getenv("VIDEO_PATH")  
output_folder = '/Users/helena/Desktop/vid/output_extract'

video_files = [f for f in os.listdir(video_path) if f.endswith(('.mp4', '.mkv', '.avi'))]
video_files = [os.path.join(video_path, video) for video in video_files]

for file in video_files:
    extract_frames_quarter_second(file, output_folder)
